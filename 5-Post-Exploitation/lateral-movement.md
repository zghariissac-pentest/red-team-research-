# Lateral movement

Lateral movement is the process of expanding access from the initial compromised host to other systems inside the environment. The goal is to move silently, escalate access, and reach high-value targets without triggering detection. Effective lateral movement depends on credential quality, network understanding, and the ability to blend into normal administrative activity.

## Objectives

Access additional systems inside the network

Escalate privileges through domain resources

Reach critical hosts such as domain controllers

Maintain low visibility during internal expansion

### Foundations

Lateral movement relies on three elements.

Valid credentials

Network reachability

A remote execution method

If one of these is missing, movement becomes noisy or impossible.

## Techniques
### Remote service execution

Using built-in Windows services is one of the most common and stealthy methods.
Examples include:

### Service creation

Remote scheduled tasks

Normal administrative tools that defenders expect

These methods blend well with domain operations.

WMI execution

Windows Management Instrumentation allows remote command execution without opening new services or leaving obvious logs.
It is useful when SMB or PSRemoting is restricted.

### SMB and admin shares

SMB admin shares such as C$ and ADMIN$ allow file deployment and tool staging.
This is often used before running a payload remotely.

### PowerShell remoting

PSRemoting provides interactive remote sessions.
It is powerful but depends on configuration and logging.
Extra care is required because defenders monitor PowerShell heavily.

### Token impersonation

Stealing or duplicating tokens gives access to new systems without explicit credentials.
This is especially effective after privilege escalation on a compromised host.

### RDP pivoting

RDP is sometimes allowed internally.
Using valid domain creds, attackers can move laterally with minimal noise.
However, session creation is visible to defenders who monitor logons.

### Application-based movement

Some environments allow movement through SQL servers, automation frameworks, or management tools.
These routes often bypass strict network controls.

### Opsec considerations

Avoid repeated execution through the same method

Rotate between protocols that fit normal administrative patterns

Minimize remote process creation events

Use the same working directories administrators use

Prefer native tools over custom binaries

### Tools

The following tools assist with movement inside a controlled environment.

Lateral movement helper

#### A Python script that:

Uses SMB or WMI to execute commands

Accepts domain credentials

Avoids noisy scanning

Token duplication utility

#### A PowerShell tool that:

Steals explorer tokens

Spawns a new process under the impersonated context

Shellcode runner

#### A small C++ loader that:

Allocates memory

Executes position-independent shellcode

Helps deploy in-memory payloads during movement
