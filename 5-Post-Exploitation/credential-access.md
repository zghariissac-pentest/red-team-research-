# Credential access

Credential access is the phase where the operator extracts, intercepts, or abuses authentication material to expand access and privilege inside the environment. The focus is efficiency, stealth, and compatibility with real enterprise defenses.

## Password dumping
### LSASS memory dumping

LSASS holds cleartext, NTLM, Kerberos tickets, and DPAPI keys.

### Techniques:

Using legitimate signed tools (ProcDump, comsvcs.dll reflective method).

Direct system calls to avoid EDR API hooking.

MiniDumpWriteDump with patchless syscall-based dumping.

Leveraging Task Manager memory dump (living-off-the-land).

### Defensive bypass tips:

Suspend LSASS only for milliseconds to reduce detection.

Avoid file dumps; stream output over named pipes to memory.

Use handle duplication to read LSASS without opening it directly.

## Credential harvesting
### Browser credential extraction

Chromium-based password stores (with DPAPI decryption).

Firefox logins.json + key4.db extraction.

Session cookies are often more valuable than credentials.

Targeted token hijacking via silent WebSession APIs.

## WiFi credentials

netsh WLAN export and registry scraping.

Useful for pivoting toward unmanaged devices.

SAM & SYSTEM hive extraction

Offline extraction from volume shadow copies.

Registry transaction logs to bypass locked hives.

## Kerberos attacks
### Ticket extraction

Extract TGT/TGS using Rubeus-like implementations.

Kerberos cache scraping on Windows + Linux.

## Golden ticket

Requires krbtgt hash.

Long-term access vector; must be used carefully to avoid abnormal ticket patterns.

Silver ticket

Forge service tickets using the service account hash.

Highly stealthy because KDC is never contacted.

Pass-the-ticket

Import stolen tickets via kerberos::ptt or custom APIs.

Opsec note: Prefer TGS-based attacks over TGT ones to reduce anomalies.

## NTLM-based attacks
### Pass-the-hash

Directly authenticate with NTLM hash.

Still powerful in hybrid environments.

Overpass-the-hash

Convert NTLM hash into a full Kerberos TGT (using RC4 key).

Helps bypass NTLM restrictions.

NTLM relay

Relay captured hashes to SMB, LDAP, HTTP endpoints.

Combine with printer bug and ADCS HTTP endpoints.

## Token abuse
### Access token duplication

Duplicate tokens from privileged processes.

Impersonate logged-on users without requiring credentials.

Token theft via thread impersonation

Use SetThreadToken for low-noise token hijacking.

Avoid process injection to reduce alerts.

Cloud token extraction

Azure refresh tokens from msalcache.json.

AWS/Google CLI credential files.

## Memory scraping
### DPAPI master key harvesting

Steal master keys from %APPDATA%\Microsoft\Protect\SID.

Use system or domain backup keys for mass decryption.

In-memory cache collection

Browser in-memory cookies.

Credential Providers cache from logon sessions.

## Keylogging
### Low-noise methods

Using Windows RawInput APIs instead of SetWindowsHookEx.

Temporary keyloggers that activate only on sensitive processes.

In-memory ring buffers that never touch disk.

Targeted keylogging

Trigger when window title contains: “VPN”, “Portal”, “Login”, “Outlook”.

Reduce output size, avoid suspicion.

## Tools

Mimikatz / Rubeus / Kekeo (reference implementations).

Seatbelt for credential-related system enumeration.

SharpDPAPI (DPAPI master key + browser secrets).

LaZagne (offline and multi-platform harvesting).

Custom syscall-based LSASS dumper (EDR-safe).

Token duplication scripts for stealthy impersonation
